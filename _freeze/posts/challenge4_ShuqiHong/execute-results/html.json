{
  "hash": "68c1076cd9bd780fd5fa183250fce07d",
  "result": {
    "markdown": "---\ntitle: \"Challenge 4\"\nauthor: \"Shuqi Hong\"\ndescription: \"More data wrangling: pivoting\"\ndate: \"6/09/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_4\n  - abc_poll\n  - eggs\n  - fed_rates\n  - hotel_bookings\n  - debt\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n\nfed <- read_csv(\"_data/FedFundsRate.csv\")\n\nfed<- fed %>% fill(`Real GDP (Percent Change)`, .direction = \"down\") %>% \n  fill(`Inflation Rate`, .direction = \"down\") %>% \n  fill(`Effective Federal Funds Rate`, .direction = \"down\") %>%\n  mutate_at (c(1:3), as.character) #%>% str()\n\nfed %>% summarise_all(funs(sum(is.na(.))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 10\n   Year Month   Day `Federal Funds Target Rate` `Federal Funds Upper Target`\n  <int> <int> <int>                       <int>                        <int>\n1     0     0     0                         442                          801\n# ℹ 5 more variables: `Federal Funds Lower Target` <int>,\n#   `Effective Federal Funds Rate` <int>, `Real GDP (Percent Change)` <int>,\n#   `Unemployment Rate` <int>, `Inflation Rate` <int>\n```\n:::\n\n```{.r .cell-code}\nglimpse(fed)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 904\nColumns: 10\n$ Year                           <chr> \"1954\", \"1954\", \"1954\", \"1954\", \"1954\",…\n$ Month                          <chr> \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"1\", \"…\n$ Day                            <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",…\n$ `Federal Funds Target Rate`    <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ `Federal Funds Upper Target`   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ `Federal Funds Lower Target`   <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ `Effective Federal Funds Rate` <dbl> 0.80, 1.22, 1.06, 0.85, 0.83, 1.28, 1.3…\n$ `Real GDP (Percent Change)`    <dbl> 4.6, 4.6, 4.6, 8.0, 8.0, 8.0, 11.9, 11.…\n$ `Unemployment Rate`            <dbl> 5.8, 6.0, 6.1, 5.7, 5.3, 5.0, 4.9, 4.7,…\n$ `Inflation Rate`               <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n```\n:::\n\n```{.r .cell-code}\nhead(fed)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 10\n  Year  Month Day   `Federal Funds Target Rate` `Federal Funds Upper Target`\n  <chr> <chr> <chr>                       <dbl>                        <dbl>\n1 1954  7     1                              NA                           NA\n2 1954  8     1                              NA                           NA\n3 1954  9     1                              NA                           NA\n4 1954  10    1                              NA                           NA\n5 1954  11    1                              NA                           NA\n6 1954  12    1                              NA                           NA\n# ℹ 5 more variables: `Federal Funds Lower Target` <dbl>,\n#   `Effective Federal Funds Rate` <dbl>, `Real GDP (Percent Change)` <dbl>,\n#   `Unemployment Rate` <dbl>, `Inflation Rate` <dbl>\n```\n:::\n\n```{.r .cell-code}\nfed %>% count(Year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 64 × 2\n   Year      n\n   <chr> <int>\n 1 1954      6\n 2 1955     12\n 3 1956     12\n 4 1957     12\n 5 1958     12\n 6 1959     12\n 7 1960     12\n 8 1961     12\n 9 1962     12\n10 1963     12\n# ℹ 54 more rows\n```\n:::\n:::\n\nDates can be added, so it should be character not factor. I also fill the several columns.\n\n\nBelow code: I just filter Federal Funds Target Rate without NA\n\n::: {.cell}\n\n```{.r .cell-code}\nTargetRate <- fed %>% \n  filter(!is.na(`Federal Funds Target Rate`)) %>% \n  select(-c(`Federal Funds Upper Target`, `Federal Funds Lower Target`))\n\nTargetRate\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 462 × 8\n   Year  Month Day   `Federal Funds Target Rate` `Effective Federal Funds Rate`\n   <chr> <chr> <chr>                       <dbl>                          <dbl>\n 1 1982  9     27                           10.2                          10.3 \n 2 1982  10    1                            10                             9.71\n 3 1982  10    7                             9.5                           9.71\n 4 1982  11    1                             9.5                           9.2 \n 5 1982  11    19                            9                             9.2 \n 6 1982  12    1                             9                             8.95\n 7 1982  12    14                            8.5                           8.95\n 8 1983  1     1                             8.5                           8.68\n 9 1983  2     1                             8.5                           8.51\n10 1983  3     1                             8.5                           8.77\n# ℹ 452 more rows\n# ℹ 3 more variables: `Real GDP (Percent Change)` <dbl>,\n#   `Unemployment Rate` <dbl>, `Inflation Rate` <dbl>\n```\n:::\n\n```{.r .cell-code}\n#newfed <- fed %>% select(-c(`Federal Funds Target Rate`,  `Federal Funds Upper Target`, `Federal Funds Lower Target`)) \n\n#newfed\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel <- read_csv(\"_data/hotel_bookings.csv\")\n\n#Find unique values in all columns\n#hotel %>% lapply(unique)\nhotel\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 119,390 × 32\n   hotel        is_canceled lead_time arrival_date_year arrival_date_month\n   <chr>              <dbl>     <dbl>             <dbl> <chr>             \n 1 Resort Hotel           0       342              2015 July              \n 2 Resort Hotel           0       737              2015 July              \n 3 Resort Hotel           0         7              2015 July              \n 4 Resort Hotel           0        13              2015 July              \n 5 Resort Hotel           0        14              2015 July              \n 6 Resort Hotel           0        14              2015 July              \n 7 Resort Hotel           0         0              2015 July              \n 8 Resort Hotel           0         9              2015 July              \n 9 Resort Hotel           1        85              2015 July              \n10 Resort Hotel           1        75              2015 July              \n# ℹ 119,380 more rows\n# ℹ 27 more variables: arrival_date_week_number <dbl>,\n#   arrival_date_day_of_month <dbl>, stays_in_weekend_nights <dbl>,\n#   stays_in_week_nights <dbl>, adults <dbl>, children <dbl>, babies <dbl>,\n#   meal <chr>, country <chr>, market_segment <chr>,\n#   distribution_channel <chr>, is_repeated_guest <dbl>,\n#   previous_cancellations <dbl>, previous_bookings_not_canceled <dbl>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotelclean <- hotel %>% \n  mutate_at(c(1,2,5,13,14,15,20,21,27,31,16), as.factor)\n\nhotelclean <- hotelclean %>%\n  mutate_at(c(6,8,9,10,11,12,18,19,21,22,26,28,29,30,17), as.integer, na.rm=T) \n\nhotelclean <- hotelclean %>%\n  mutate_at(c(4,7,32,3), as.character) %>% select(-company) %>% mutate(state = case_when\n         (is_canceled == \"1\" ~ \"canceled\",\n          is_canceled == \"0\" ~ \"regular\")) %>% \n  select(-is_canceled) \n\n#separate reservation status date into year, month, date columns\n\nhotelclean <- hotelclean %>% separate(reservation_status_date, into= c(\"reservation_status_year\",\"reservation_month\", \"reservation_status_date\"), sep=\"-\")\n\nhotelclean \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 119,390 × 33\n   hotel   lead_time arrival_date_year arrival_date_month arrival_date_week_nu…¹\n   <fct>   <chr>     <chr>             <fct>                               <int>\n 1 Resort… 342       2015              July                                   27\n 2 Resort… 737       2015              July                                   27\n 3 Resort… 7         2015              July                                   27\n 4 Resort… 13        2015              July                                   27\n 5 Resort… 14        2015              July                                   27\n 6 Resort… 14        2015              July                                   27\n 7 Resort… 0         2015              July                                   27\n 8 Resort… 9         2015              July                                   27\n 9 Resort… 85        2015              July                                   27\n10 Resort… 75        2015              July                                   27\n# ℹ 119,380 more rows\n# ℹ abbreviated name: ¹​arrival_date_week_number\n# ℹ 28 more variables: arrival_date_day_of_month <chr>,\n#   stays_in_weekend_nights <int>, stays_in_week_nights <int>, adults <int>,\n#   children <int>, babies <int>, meal <fct>, country <fct>,\n#   market_segment <fct>, distribution_channel <fct>, is_repeated_guest <int>,\n#   previous_cancellations <int>, previous_bookings_not_canceled <int>, …\n```\n:::\n\n```{.r .cell-code}\nglimpse(hotelclean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 119,390\nColumns: 33\n$ hotel                          <fct> Resort Hotel, Resort Hotel, Resort Hote…\n$ lead_time                      <chr> \"342\", \"737\", \"7\", \"13\", \"14\", \"14\", \"0…\n$ arrival_date_year              <chr> \"2015\", \"2015\", \"2015\", \"2015\", \"2015\",…\n$ arrival_date_month             <fct> July, July, July, July, July, July, Jul…\n$ arrival_date_week_number       <int> 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,…\n$ arrival_date_day_of_month      <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\",…\n$ stays_in_weekend_nights        <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ stays_in_week_nights           <int> 0, 0, 1, 1, 2, 2, 2, 2, 3, 3, 4, 4, 4, …\n$ adults                         <int> 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ children                       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ babies                         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ meal                           <fct> BB, BB, BB, BB, BB, BB, BB, FB, BB, HB,…\n$ country                        <fct> PRT, PRT, GBR, GBR, GBR, GBR, PRT, PRT,…\n$ market_segment                 <fct> Direct, Direct, Direct, Corporate, Onli…\n$ distribution_channel           <fct> Direct, Direct, Direct, Corporate, TA/T…\n$ is_repeated_guest              <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ previous_cancellations         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ previous_bookings_not_canceled <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ reserved_room_type             <fct> C, C, A, A, A, A, C, C, A, D, E, D, D, …\n$ assigned_room_type             <int> 3, 3, 3, 1, 1, 1, 3, 3, 1, 4, 5, 4, 5, …\n$ booking_changes                <int> 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ deposit_type                   <chr> \"No Deposit\", \"No Deposit\", \"No Deposit…\n$ agent                          <chr> \"NULL\", \"NULL\", \"NULL\", \"304\", \"240\", \"…\n$ days_in_waiting_list           <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ customer_type                  <fct> Transient, Transient, Transient, Transi…\n$ adr                            <int> 0, 0, 75, 75, 98, 98, 107, 103, 82, 105…\n$ required_car_parking_spaces    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ total_of_special_requests      <int> 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 3, …\n$ reservation_status             <fct> Check-Out, Check-Out, Check-Out, Check-…\n$ reservation_status_year        <chr> \"2015\", \"2015\", \"2015\", \"2015\", \"2015\",…\n$ reservation_month              <chr> \"07\", \"07\", \"07\", \"07\", \"07\", \"07\", \"07…\n$ reservation_status_date        <chr> \"01\", \"01\", \"02\", \"02\", \"03\", \"03\", \"03…\n$ state                          <chr> \"regular\", \"regular\", \"regular\", \"regul…\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
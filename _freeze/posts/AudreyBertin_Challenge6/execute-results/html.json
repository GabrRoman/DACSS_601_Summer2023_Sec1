{
  "hash": "54fef7b69c50a5ed9f8ee48b530ca1a4",
  "result": {
    "markdown": "---\ntitle: \"Challenge 6\"\nauthor: \"Audrey Bertin\"\ndescription: \"Visualizing Time and Relationships\"\ndate: \"6/4/2023\"\nformat:\n  html:\n    df-print: paged\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_6\n  - air_bnb\n  - ggplot2\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nFor this challenge, I'll be reading in the `AB_NYC_1019.csv ⭐⭐⭐⭐⭐` data.\n\nThis was the dataset I read for challenge 5, so I will be continuing to visualize it and add on to what I discovered in the last challenge. \n\nFor the data overview below, I will be reproducing the steps from challenge 5 so that the data is in the same format.\n\n## The Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb <- readr::read_csv(\"_data/AB_NYC_2019.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(airbnb)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 48,895\nColumns: 16\n$ id                             <dbl> 2539, 2595, 3647, 3831, 5022, 5099, 512…\n$ name                           <chr> \"Clean & quiet apt home by the park\", \"…\n$ host_id                        <dbl> 2787, 2845, 4632, 4869, 7192, 7322, 735…\n$ host_name                      <chr> \"John\", \"Jennifer\", \"Elisabeth\", \"LisaR…\n$ neighbourhood_group            <chr> \"Brooklyn\", \"Manhattan\", \"Manhattan\", \"…\n$ neighbourhood                  <chr> \"Kensington\", \"Midtown\", \"Harlem\", \"Cli…\n$ latitude                       <dbl> 40.64749, 40.75362, 40.80902, 40.68514,…\n$ longitude                      <dbl> -73.97237, -73.98377, -73.94190, -73.95…\n$ room_type                      <chr> \"Private room\", \"Entire home/apt\", \"Pri…\n$ price                          <dbl> 149, 225, 150, 89, 80, 200, 60, 79, 79,…\n$ minimum_nights                 <dbl> 1, 1, 3, 1, 10, 3, 45, 2, 2, 1, 5, 2, 4…\n$ number_of_reviews              <dbl> 9, 45, 0, 270, 9, 74, 49, 430, 118, 160…\n$ last_review                    <date> 2018-10-19, 2019-05-21, NA, 2019-07-05…\n$ reviews_per_month              <dbl> 0.21, 0.38, NA, 4.64, 0.10, 0.59, 0.40,…\n$ calculated_host_listings_count <dbl> 6, 2, 1, 1, 1, 1, 1, 1, 1, 4, 1, 1, 3, …\n$ availability_365               <dbl> 365, 355, 365, 194, 0, 129, 0, 220, 0, …\n```\n:::\n:::\n\n\nThis dataset has 48,895 rows and 16 columns. It contains information on different AirBnB properties located in New York City, NY.\n\nEach row represents a single property in the city. For each property, we have the following information;\n\n- `id`: unique identifier for the property\n- `name`: descriptive name shown on the AirBnB website that customers see when clicking on the property\n- `host_id`: unique identifier for the host of the property\n- `host_name`: first name of the property host\n- `neighbourhood_group`: borough name where property is located\n- `neighborhood`: neighborhood within the burough (more detailed location)\n- `latitude/longitude`: geographical coordinates of property\n- `room_type`: what type of property is being booked (private room in shared home, a whole home/apartment, etc)\n- `price`: nightly price, presumably in USD\n- `minimum_nights`: minimum length of stay\n- `number_of_reviews`: total number of reviews for the property on AirBnB so far\n- `last_review`: date of last review\n- `reviews_per_month`: average number of reviews left for the property each month\n- `calculated_host_listings_count`: number of listings/properties that this specific host has on AirBnB overall\n- `availability_365`: number of nights in the year that the property is available for booking on AirBnB\n\nRoom types include:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(airbnb$room_type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Private room\"    \"Entire home/apt\" \"Shared room\"    \n```\n:::\n:::\n\n\nAll boroughs appear to be included:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(airbnb$neighbourhood_group)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Brooklyn\"      \"Manhattan\"     \"Queens\"        \"Staten Island\"\n[5] \"Bronx\"        \n```\n:::\n:::\n\n\nFor each borough, we have the following count of neighborhoods and properties:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb %>%\n  group_by(neighbourhood_group) %>%\n  summarize(n_properties = n(), n_neighborhoods = n_distinct(neighbourhood)) %>%\n  arrange(desc(n_properties))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"neighbourhood_group\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n_properties\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n_neighborhoods\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Manhattan\",\"2\":\"21661\",\"3\":\"32\"},{\"1\":\"Brooklyn\",\"2\":\"20104\",\"3\":\"47\"},{\"1\":\"Queens\",\"2\":\"5666\",\"3\":\"51\"},{\"1\":\"Bronx\",\"2\":\"1091\",\"3\":\"48\"},{\"1\":\"Staten Island\",\"2\":\"373\",\"3\":\"43\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nMost of the properties are located in Manhattan and Brooklyn, with significantly fewer in Queens, the Bronx, and Staten Island. Within each borough, we have a few dozen neighborhoods covered, so this data seems to have pretty good coverage of the city with no obvious big missing areas of data.\n\n## Tidy Data\n\nData is already in a tidy format, so no pivoting is necessary. Each row represents a single property, which can't be broken down into a longer format.\n\nHowever, we can mutate a few of the variables to get them into a better format for visualization. Specifically, the following variables should be turned into factors:\n\n- `neighbourhood_group`\n- `neighbourhood`\n- `room_type`\n\nThere are a few other modifications that can be made (e.g. converting some doubles to integers), but they are not necessary for the purpose of this visualization.\n\nWe do this mutation below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb_tidy <- airbnb %>%\n  mutate(neighbourhood_group = as_factor(neighbourhood_group),\n         neighbourhood = as_factor(neighbourhood),\n         room_type = as_factor(room_type))\n```\n:::\n\n\n\n## Additional Mutation\n\nIn order to create variables for time-dependent visualization, it could help to do some additional steps to our data beyond what was done for challenge 5.\n\nThe only time related variable we have is `last_review` which has a `YYYY-MM-DD` format. To get something useful/interesting out of this date, it would help to be able to group these dates into larger categories.\n\nFor this example, we'll create a YEAR-only version of the date, so that we can then group by *year* of last review to produce a graph and compare properties over time.\n\nBelow, we create this variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb_tidy <- airbnb_tidy %>%\n  rowwise() %>%\n  mutate(year_last_review = as.numeric(str_split(last_review, pattern=\"-\")[[1]][1]))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(airbnb_tidy$year_last_review)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 2018 2019   NA 2017 2011 2016 2012 2015 2013 2014\n```\n:::\n:::\n\n\n\n\n## Time Dependent Visualization\n\nFor our time dependent visualization, we can graph the number of unique properties by last review date. To do this, we'll need to create a summary using group by with our new variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb_tidy %>%\n  group_by(year_last_review) %>%\n  summarize(n_properties = n_distinct(id)) %>%\n  filter(!is.na(year_last_review)) %>%\n  ggplot(aes(x= year_last_review, y = n_properties)) + \n  geom_line() +\n  xlab(\"Year of Last Review\") +\n  ylab(\"Number of Properties\") + \n  ggtitle(\"Number of AirBnB Properties in NYC by Date of Last Review\") +\n  scale_x_continuous(breaks = c(2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019), labels = c(\"2011\", \"2012\", \"2013\", \"2014\", \"2015\", \"2016\", \"2017\", \"2018\", \"2019\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](AudreyBertin_Challenge6_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nWith this graph, we can see that the vast majority of properties have a last review date in 2019, the most recent available year. There is also a clear pattern over time, where there are very few properties with early last review dates, and as the years get more recent, there are many more properties with a last review date in that year. This indicates that the dataset is mostly newer properties versus properties that have not been rented in a long time.\n\n\n## Visualizing Part-Whole Relationships\n\nIn challenge 5, we calculated the number of distinct properties by neighborhood (borough) in NYC. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nairbnb_by_neighborhood <- airbnb %>%\n  group_by(neighbourhood_group) %>%\n  summarize(n_properties = n()) %>%\n  arrange(desc(n_properties))\n\nairbnb_by_neighborhood\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"neighbourhood_group\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n_properties\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Manhattan\",\"2\":\"21661\"},{\"1\":\"Brooklyn\",\"2\":\"20104\"},{\"1\":\"Queens\",\"2\":\"5666\"},{\"1\":\"Bronx\",\"2\":\"1091\"},{\"1\":\"Staten Island\",\"2\":\"373\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nIn this challenge, we can visualize these results, looking at the number of properties by neighborhood. A stacked bar chart can do this for us:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbar_graph <- airbnb_by_neighborhood %>%\n  ggplot(aes(x=\"\", y=n_properties, fill=neighbourhood_group)) +\n  geom_col(position=\"fill\") +\n  scale_fill_brewer(palette = \"Dark2\") +\n  xlab(NULL) +\n  ylab(\"% of Properties\") +\n  ggtitle(\"Percentage of AirBnBs in NYC By Borough\") +\n  theme_minimal()\n\nbar_graph\n```\n\n::: {.cell-output-display}\n![](AudreyBertin_Challenge6_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\nWe can also convert this to a pie chart by adding one line of code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbar_graph + coord_polar(\"y\", start=0)\n```\n\n::: {.cell-output-display}\n![](AudreyBertin_Challenge6_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "AudreyBertin_Challenge6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "5bc4aec97437758ad1d0107189483774",
  "result": {
    "markdown": "---\ntitle: \"Challenge 8_Solution \"\nauthor: \"Zhongyue Lin\"\ndescription: \"Joining Data\"\ndate: \"6/19/2023\"\nformat:\n  html:\n    df-print: paged\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - railroads\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(scales)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in multiple data sets, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  mutate variables as needed (including sanity checks)\n4)  join two or more data sets and analyze some aspect of the joined data\n\n(be sure to only include the category tags for the data you use!)\n\n## Read in data & Tidy Data\n\nRead in one (or more) of the following datasets, using the correct R package and command.\n  - railroads  ⭐⭐⭐\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read the file, skipping the first 3 rows and specifying column names, then remove all columns that are completely empty, then replace NA values in the \"COUNTY\" column with \"/\" when \"STATE\" contains \"Total\"\ndata_clean <- read_excel(\"_data/StateCounty2012.xls\", skip = 3) %>%\n  select_if(~!all(is.na(.))) %>%\n  mutate(COUNTY = ifelse(is.na(COUNTY) & grepl(\"Total\", STATE), \"/\", COUNTY))\n\n# Print out the first few lines of the cleaned data\nhead(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"APO\",\"3\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"ANCHORAGE\",\"3\":\"7\"},{\"1\":\"AK\",\"2\":\"FAIRBANKS NORTH STAR\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"JUNEAU\",\"3\":\"3\"},{\"1\":\"AK\",\"2\":\"MATANUSKA-SUSITNA\",\"3\":\"2\"},{\"1\":\"AK\",\"2\":\"SITKA\",\"3\":\"1\"},{\"1\":\"AK\",\"2\":\"SKAGWAY MUNICIPALITY\",\"3\":\"88\"},{\"1\":\"AK Total\",\"2\":\"/\",\"3\":\"103\"},{\"1\":\"AL\",\"2\":\"AUTAUGA\",\"3\":\"102\"},{\"1\":\"AL\",\"2\":\"BALDWIN\",\"3\":\"143\"},{\"1\":\"AL\",\"2\":\"BARBOUR\",\"3\":\"1\"},{\"1\":\"AL\",\"2\":\"BIBB\",\"3\":\"25\"},{\"1\":\"AL\",\"2\":\"BLOUNT\",\"3\":\"154\"},{\"1\":\"AL\",\"2\":\"BULLOCK\",\"3\":\"13\"},{\"1\":\"AL\",\"2\":\"BUTLER\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"CALHOUN\",\"3\":\"45\"},{\"1\":\"AL\",\"2\":\"CHAMBERS\",\"3\":\"13\"},{\"1\":\"AL\",\"2\":\"CHEROKEE\",\"3\":\"9\"},{\"1\":\"AL\",\"2\":\"CHILTON\",\"3\":\"72\"},{\"1\":\"AL\",\"2\":\"CHOCTAW\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"CLARKE\",\"3\":\"26\"},{\"1\":\"AL\",\"2\":\"CLAY\",\"3\":\"10\"},{\"1\":\"AL\",\"2\":\"CLEBURNE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"COFFEE\",\"3\":\"14\"},{\"1\":\"AL\",\"2\":\"COLBERT\",\"3\":\"199\"},{\"1\":\"AL\",\"2\":\"CONECUH\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"COOSA\",\"3\":\"5\"},{\"1\":\"AL\",\"2\":\"COVINGTON\",\"3\":\"12\"},{\"1\":\"AL\",\"2\":\"CRENSHAW\",\"3\":\"5\"},{\"1\":\"AL\",\"2\":\"CULLMAN\",\"3\":\"129\"},{\"1\":\"AL\",\"2\":\"DALE\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"DALLAS\",\"3\":\"122\"},{\"1\":\"AL\",\"2\":\"DEKALB\",\"3\":\"33\"},{\"1\":\"AL\",\"2\":\"ELMORE\",\"3\":\"116\"},{\"1\":\"AL\",\"2\":\"ESCAMBIA\",\"3\":\"47\"},{\"1\":\"AL\",\"2\":\"ETOWAH\",\"3\":\"78\"},{\"1\":\"AL\",\"2\":\"FAYETTE\",\"3\":\"3\"},{\"1\":\"AL\",\"2\":\"FRANKLIN\",\"3\":\"40\"},{\"1\":\"AL\",\"2\":\"GENEVA\",\"3\":\"8\"},{\"1\":\"AL\",\"2\":\"GREENE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"HALE\",\"3\":\"8\"},{\"1\":\"AL\",\"2\":\"HENRY\",\"3\":\"1\"},{\"1\":\"AL\",\"2\":\"HOUSTON\",\"3\":\"46\"},{\"1\":\"AL\",\"2\":\"JACKSON\",\"3\":\"55\"},{\"1\":\"AL\",\"2\":\"JEFFERSON\",\"3\":\"990\"},{\"1\":\"AL\",\"2\":\"LAMAR\",\"3\":\"25\"},{\"1\":\"AL\",\"2\":\"LAUDERDALE\",\"3\":\"117\"},{\"1\":\"AL\",\"2\":\"LAWRENCE\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"LEE\",\"3\":\"46\"},{\"1\":\"AL\",\"2\":\"LIMESTONE\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"LOWNDES\",\"3\":\"7\"},{\"1\":\"AL\",\"2\":\"MACON\",\"3\":\"6\"},{\"1\":\"AL\",\"2\":\"MADISON\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"MARENGO\",\"3\":\"16\"},{\"1\":\"AL\",\"2\":\"MARION\",\"3\":\"17\"},{\"1\":\"AL\",\"2\":\"MARSHALL\",\"3\":\"29\"},{\"1\":\"AL\",\"2\":\"MOBILE\",\"3\":\"331\"},{\"1\":\"AL\",\"2\":\"MONROE\",\"3\":\"43\"},{\"1\":\"AL\",\"2\":\"MONTGOMERY\",\"3\":\"102\"},{\"1\":\"AL\",\"2\":\"MORGAN\",\"3\":\"42\"},{\"1\":\"AL\",\"2\":\"PERRY\",\"3\":\"4\"},{\"1\":\"AL\",\"2\":\"PICKENS\",\"3\":\"24\"},{\"1\":\"AL\",\"2\":\"PIKE\",\"3\":\"19\"},{\"1\":\"AL\",\"2\":\"RANDOLPH\",\"3\":\"39\"},{\"1\":\"AL\",\"2\":\"RUSSELL\",\"3\":\"38\"},{\"1\":\"AL\",\"2\":\"SHELBY\",\"3\":\"158\"},{\"1\":\"AL\",\"2\":\"ST CLAIR\",\"3\":\"162\"},{\"1\":\"AL\",\"2\":\"SUMTER\",\"3\":\"9\"},{\"1\":\"AL\",\"2\":\"TALLADEGA\",\"3\":\"42\"},{\"1\":\"AL\",\"2\":\"TALLAPOOSA\",\"3\":\"19\"},{\"1\":\"AL\",\"2\":\"TUSCALOOSA\",\"3\":\"60\"},{\"1\":\"AL\",\"2\":\"WALKER\",\"3\":\"192\"},{\"1\":\"AL\",\"2\":\"WASHINGTON\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"WILCOX\",\"3\":\"11\"},{\"1\":\"AL\",\"2\":\"WINSTON\",\"3\":\"45\"},{\"1\":\"AL Total\",\"2\":\"/\",\"3\":\"4257\"},{\"1\":\"AP\",\"2\":\"APO\",\"3\":\"1\"},{\"1\":\"AP Total1\",\"2\":\"/\",\"3\":\"1\"},{\"1\":\"AR\",\"2\":\"ARKANSAS\",\"3\":\"11\"},{\"1\":\"AR\",\"2\":\"ASHLEY\",\"3\":\"18\"},{\"1\":\"AR\",\"2\":\"BAXTER\",\"3\":\"25\"},{\"1\":\"AR\",\"2\":\"BENTON\",\"3\":\"35\"},{\"1\":\"AR\",\"2\":\"BOONE\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"BRADLEY\",\"3\":\"8\"},{\"1\":\"AR\",\"2\":\"CALHOUN\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"CHICOT\",\"3\":\"3\"},{\"1\":\"AR\",\"2\":\"CLARK\",\"3\":\"40\"},{\"1\":\"AR\",\"2\":\"CLAY\",\"3\":\"13\"},{\"1\":\"AR\",\"2\":\"CLEBURNE\",\"3\":\"8\"},{\"1\":\"AR\",\"2\":\"CLEVELAND\",\"3\":\"79\"},{\"1\":\"AR\",\"2\":\"COLUMBIA\",\"3\":\"5\"},{\"1\":\"AR\",\"2\":\"CONWAY\",\"3\":\"19\"},{\"1\":\"AR\",\"2\":\"CRAIGHEAD\",\"3\":\"61\"},{\"1\":\"AR\",\"2\":\"CRAWFORD\",\"3\":\"55\"},{\"1\":\"AR\",\"2\":\"CRITTENDEN\",\"3\":\"48\"},{\"1\":\"AR\",\"2\":\"CROSS\",\"3\":\"30\"},{\"1\":\"AR\",\"2\":\"DALLAS\",\"3\":\"12\"},{\"1\":\"AR\",\"2\":\"DESHA\",\"3\":\"15\"},{\"1\":\"AR\",\"2\":\"DREW\",\"3\":\"34\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Identify the rows where \"STATE\" is \"CANADA\" and replace NA values in \"COUNTY\" with \"Canada\", then remove empty rows above the \"CANADA\" row\ndata_clean <- data_clean %>%\n  mutate(COUNTY = replace(COUNTY, STATE == \"CANADA\", \"Canada\")) %>%\n  slice(1:(nrow(.)-4))\n\n# Print out the last few lines of the cleaned data to check\ntail(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"WI\",\"2\":\"ROCK\",\"3\":\"138\"},{\"1\":\"WI\",\"2\":\"RUSK\",\"3\":\"21\"},{\"1\":\"WI\",\"2\":\"SAUK\",\"3\":\"29\"},{\"1\":\"WI\",\"2\":\"SAWYER\",\"3\":\"14\"},{\"1\":\"WI\",\"2\":\"SHAWANO\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"SHEBOYGAN\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"ST CROIX\",\"3\":\"168\"},{\"1\":\"WI\",\"2\":\"TAYLOR\",\"3\":\"15\"},{\"1\":\"WI\",\"2\":\"TREMPEALEAU\",\"3\":\"54\"},{\"1\":\"WI\",\"2\":\"VERNON\",\"3\":\"48\"},{\"1\":\"WI\",\"2\":\"VILAS\",\"3\":\"5\"},{\"1\":\"WI\",\"2\":\"WALWORTH\",\"3\":\"47\"},{\"1\":\"WI\",\"2\":\"WASHBURN\",\"3\":\"23\"},{\"1\":\"WI\",\"2\":\"WASHINGTON\",\"3\":\"37\"},{\"1\":\"WI\",\"2\":\"WAUKESHA\",\"3\":\"96\"},{\"1\":\"WI\",\"2\":\"WAUPACA\",\"3\":\"34\"},{\"1\":\"WI\",\"2\":\"WAUSHARA\",\"3\":\"13\"},{\"1\":\"WI\",\"2\":\"WINNEBAGO\",\"3\":\"95\"},{\"1\":\"WI\",\"2\":\"WOOD\",\"3\":\"119\"},{\"1\":\"WI Total\",\"2\":\"/\",\"3\":\"3773\"},{\"1\":\"WV\",\"2\":\"BARBOUR\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"BERKELEY\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"BOONE\",\"3\":\"50\"},{\"1\":\"WV\",\"2\":\"BRAXTON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"BROOKE\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"CABELL\",\"3\":\"406\"},{\"1\":\"WV\",\"2\":\"CLAY\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"DODDRIDGE\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"FAYETTE\",\"3\":\"30\"},{\"1\":\"WV\",\"2\":\"GILMER\",\"3\":\"1\"},{\"1\":\"WV\",\"2\":\"GRANT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"GREENBRIER\",\"3\":\"75\"},{\"1\":\"WV\",\"2\":\"HAMPSHIRE\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HANCOCK\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HARDY\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"HARRISON\",\"3\":\"51\"},{\"1\":\"WV\",\"2\":\"JACKSON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"JEFFERSON\",\"3\":\"56\"},{\"1\":\"WV\",\"2\":\"KANAWHA\",\"3\":\"130\"},{\"1\":\"WV\",\"2\":\"LEWIS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"LINCOLN\",\"3\":\"107\"},{\"1\":\"WV\",\"2\":\"LOGAN\",\"3\":\"61\"},{\"1\":\"WV\",\"2\":\"MARION\",\"3\":\"16\"},{\"1\":\"WV\",\"2\":\"MARSHALL\",\"3\":\"26\"},{\"1\":\"WV\",\"2\":\"MASON\",\"3\":\"34\"},{\"1\":\"WV\",\"2\":\"MCDOWELL\",\"3\":\"43\"},{\"1\":\"WV\",\"2\":\"MERCER\",\"3\":\"387\"},{\"1\":\"WV\",\"2\":\"MINERAL\",\"3\":\"223\"},{\"1\":\"WV\",\"2\":\"MINGO\",\"3\":\"168\"},{\"1\":\"WV\",\"2\":\"MONONGALIA\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"MONROE\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"MORGAN\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"NICHOLAS\",\"3\":\"6\"},{\"1\":\"WV\",\"2\":\"OHIO\",\"3\":\"25\"},{\"1\":\"WV\",\"2\":\"PLEASANTS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"POCAHONTAS\",\"3\":\"13\"},{\"1\":\"WV\",\"2\":\"PRESTON\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"PUTNAM\",\"3\":\"83\"},{\"1\":\"WV\",\"2\":\"RALEIGH\",\"3\":\"98\"},{\"1\":\"WV\",\"2\":\"RANDOLPH\",\"3\":\"21\"},{\"1\":\"WV\",\"2\":\"RITCHIE\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"ROANE\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"SUMMERS\",\"3\":\"153\"},{\"1\":\"WV\",\"2\":\"TAYLOR\",\"3\":\"94\"},{\"1\":\"WV\",\"2\":\"TUCKER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"TYLER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"UPSHUR\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WAYNE\",\"3\":\"217\"},{\"1\":\"WV\",\"2\":\"WEBSTER\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WETZEL\",\"3\":\"9\"},{\"1\":\"WV\",\"2\":\"WIRT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"WOOD\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"WYOMING\",\"3\":\"63\"},{\"1\":\"WV Total\",\"2\":\"/\",\"3\":\"3213\"},{\"1\":\"WY\",\"2\":\"ALBANY\",\"3\":\"90\"},{\"1\":\"WY\",\"2\":\"BIG HORN\",\"3\":\"70\"},{\"1\":\"WY\",\"2\":\"CAMPBELL\",\"3\":\"386\"},{\"1\":\"WY\",\"2\":\"CARBON\",\"3\":\"168\"},{\"1\":\"WY\",\"2\":\"CONVERSE\",\"3\":\"211\"},{\"1\":\"WY\",\"2\":\"CROOK\",\"3\":\"33\"},{\"1\":\"WY\",\"2\":\"FREMONT\",\"3\":\"42\"},{\"1\":\"WY\",\"2\":\"GOSHEN\",\"3\":\"244\"},{\"1\":\"WY\",\"2\":\"HOT SPRINGS\",\"3\":\"4\"},{\"1\":\"WY\",\"2\":\"JOHNSON\",\"3\":\"18\"},{\"1\":\"WY\",\"2\":\"LARAMIE\",\"3\":\"737\"},{\"1\":\"WY\",\"2\":\"LINCOLN\",\"3\":\"25\"},{\"1\":\"WY\",\"2\":\"NATRONA\",\"3\":\"92\"},{\"1\":\"WY\",\"2\":\"NIOBRARA\",\"3\":\"51\"},{\"1\":\"WY\",\"2\":\"PARK\",\"3\":\"29\"},{\"1\":\"WY\",\"2\":\"PLATTE\",\"3\":\"129\"},{\"1\":\"WY\",\"2\":\"SHERIDAN\",\"3\":\"252\"},{\"1\":\"WY\",\"2\":\"SUBLETTE\",\"3\":\"3\"},{\"1\":\"WY\",\"2\":\"SWEETWATER\",\"3\":\"196\"},{\"1\":\"WY\",\"2\":\"UINTA\",\"3\":\"49\"},{\"1\":\"WY\",\"2\":\"WASHAKIE\",\"3\":\"10\"},{\"1\":\"WY\",\"2\":\"WESTON\",\"3\":\"37\"},{\"1\":\"WY Total\",\"2\":\"/\",\"3\":\"2876\"},{\"1\":\"Grand Total\",\"2\":\"/\",\"3\":\"255432\"},{\"1\":\"NA\",\"2\":\"NA\",\"3\":\"NA\"},{\"1\":\"CANADA\",\"2\":\"Canada\",\"3\":\"662\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Remove the row before the \"CANADA\" row\ndata_clean <- data_clean %>%\n  slice(-which(.$STATE == \"CANADA\") + 1)\n\n# Print out the last few lines of the cleaned data to check\ntail(data_clean,100)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"WI\",\"2\":\"RACINE\",\"3\":\"100\"},{\"1\":\"WI\",\"2\":\"ROCK\",\"3\":\"138\"},{\"1\":\"WI\",\"2\":\"RUSK\",\"3\":\"21\"},{\"1\":\"WI\",\"2\":\"SAUK\",\"3\":\"29\"},{\"1\":\"WI\",\"2\":\"SAWYER\",\"3\":\"14\"},{\"1\":\"WI\",\"2\":\"SHAWANO\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"SHEBOYGAN\",\"3\":\"9\"},{\"1\":\"WI\",\"2\":\"ST CROIX\",\"3\":\"168\"},{\"1\":\"WI\",\"2\":\"TAYLOR\",\"3\":\"15\"},{\"1\":\"WI\",\"2\":\"TREMPEALEAU\",\"3\":\"54\"},{\"1\":\"WI\",\"2\":\"VERNON\",\"3\":\"48\"},{\"1\":\"WI\",\"2\":\"VILAS\",\"3\":\"5\"},{\"1\":\"WI\",\"2\":\"WALWORTH\",\"3\":\"47\"},{\"1\":\"WI\",\"2\":\"WASHBURN\",\"3\":\"23\"},{\"1\":\"WI\",\"2\":\"WASHINGTON\",\"3\":\"37\"},{\"1\":\"WI\",\"2\":\"WAUKESHA\",\"3\":\"96\"},{\"1\":\"WI\",\"2\":\"WAUPACA\",\"3\":\"34\"},{\"1\":\"WI\",\"2\":\"WAUSHARA\",\"3\":\"13\"},{\"1\":\"WI\",\"2\":\"WINNEBAGO\",\"3\":\"95\"},{\"1\":\"WI\",\"2\":\"WOOD\",\"3\":\"119\"},{\"1\":\"WI Total\",\"2\":\"/\",\"3\":\"3773\"},{\"1\":\"WV\",\"2\":\"BARBOUR\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"BERKELEY\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"BOONE\",\"3\":\"50\"},{\"1\":\"WV\",\"2\":\"BRAXTON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"BROOKE\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"CABELL\",\"3\":\"406\"},{\"1\":\"WV\",\"2\":\"CLAY\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"DODDRIDGE\",\"3\":\"4\"},{\"1\":\"WV\",\"2\":\"FAYETTE\",\"3\":\"30\"},{\"1\":\"WV\",\"2\":\"GILMER\",\"3\":\"1\"},{\"1\":\"WV\",\"2\":\"GRANT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"GREENBRIER\",\"3\":\"75\"},{\"1\":\"WV\",\"2\":\"HAMPSHIRE\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HANCOCK\",\"3\":\"37\"},{\"1\":\"WV\",\"2\":\"HARDY\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"HARRISON\",\"3\":\"51\"},{\"1\":\"WV\",\"2\":\"JACKSON\",\"3\":\"22\"},{\"1\":\"WV\",\"2\":\"JEFFERSON\",\"3\":\"56\"},{\"1\":\"WV\",\"2\":\"KANAWHA\",\"3\":\"130\"},{\"1\":\"WV\",\"2\":\"LEWIS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"LINCOLN\",\"3\":\"107\"},{\"1\":\"WV\",\"2\":\"LOGAN\",\"3\":\"61\"},{\"1\":\"WV\",\"2\":\"MARION\",\"3\":\"16\"},{\"1\":\"WV\",\"2\":\"MARSHALL\",\"3\":\"26\"},{\"1\":\"WV\",\"2\":\"MASON\",\"3\":\"34\"},{\"1\":\"WV\",\"2\":\"MCDOWELL\",\"3\":\"43\"},{\"1\":\"WV\",\"2\":\"MERCER\",\"3\":\"387\"},{\"1\":\"WV\",\"2\":\"MINERAL\",\"3\":\"223\"},{\"1\":\"WV\",\"2\":\"MINGO\",\"3\":\"168\"},{\"1\":\"WV\",\"2\":\"MONONGALIA\",\"3\":\"19\"},{\"1\":\"WV\",\"2\":\"MONROE\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"MORGAN\",\"3\":\"33\"},{\"1\":\"WV\",\"2\":\"NICHOLAS\",\"3\":\"6\"},{\"1\":\"WV\",\"2\":\"OHIO\",\"3\":\"25\"},{\"1\":\"WV\",\"2\":\"PLEASANTS\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"POCAHONTAS\",\"3\":\"13\"},{\"1\":\"WV\",\"2\":\"PRESTON\",\"3\":\"35\"},{\"1\":\"WV\",\"2\":\"PUTNAM\",\"3\":\"83\"},{\"1\":\"WV\",\"2\":\"RALEIGH\",\"3\":\"98\"},{\"1\":\"WV\",\"2\":\"RANDOLPH\",\"3\":\"21\"},{\"1\":\"WV\",\"2\":\"RITCHIE\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"ROANE\",\"3\":\"3\"},{\"1\":\"WV\",\"2\":\"SUMMERS\",\"3\":\"153\"},{\"1\":\"WV\",\"2\":\"TAYLOR\",\"3\":\"94\"},{\"1\":\"WV\",\"2\":\"TUCKER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"TYLER\",\"3\":\"2\"},{\"1\":\"WV\",\"2\":\"UPSHUR\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WAYNE\",\"3\":\"217\"},{\"1\":\"WV\",\"2\":\"WEBSTER\",\"3\":\"5\"},{\"1\":\"WV\",\"2\":\"WETZEL\",\"3\":\"9\"},{\"1\":\"WV\",\"2\":\"WIRT\",\"3\":\"7\"},{\"1\":\"WV\",\"2\":\"WOOD\",\"3\":\"108\"},{\"1\":\"WV\",\"2\":\"WYOMING\",\"3\":\"63\"},{\"1\":\"WV Total\",\"2\":\"/\",\"3\":\"3213\"},{\"1\":\"WY\",\"2\":\"ALBANY\",\"3\":\"90\"},{\"1\":\"WY\",\"2\":\"BIG HORN\",\"3\":\"70\"},{\"1\":\"WY\",\"2\":\"CAMPBELL\",\"3\":\"386\"},{\"1\":\"WY\",\"2\":\"CARBON\",\"3\":\"168\"},{\"1\":\"WY\",\"2\":\"CONVERSE\",\"3\":\"211\"},{\"1\":\"WY\",\"2\":\"CROOK\",\"3\":\"33\"},{\"1\":\"WY\",\"2\":\"FREMONT\",\"3\":\"42\"},{\"1\":\"WY\",\"2\":\"GOSHEN\",\"3\":\"244\"},{\"1\":\"WY\",\"2\":\"HOT SPRINGS\",\"3\":\"4\"},{\"1\":\"WY\",\"2\":\"JOHNSON\",\"3\":\"18\"},{\"1\":\"WY\",\"2\":\"LARAMIE\",\"3\":\"737\"},{\"1\":\"WY\",\"2\":\"LINCOLN\",\"3\":\"25\"},{\"1\":\"WY\",\"2\":\"NATRONA\",\"3\":\"92\"},{\"1\":\"WY\",\"2\":\"NIOBRARA\",\"3\":\"51\"},{\"1\":\"WY\",\"2\":\"PARK\",\"3\":\"29\"},{\"1\":\"WY\",\"2\":\"PLATTE\",\"3\":\"129\"},{\"1\":\"WY\",\"2\":\"SHERIDAN\",\"3\":\"252\"},{\"1\":\"WY\",\"2\":\"SUBLETTE\",\"3\":\"3\"},{\"1\":\"WY\",\"2\":\"SWEETWATER\",\"3\":\"196\"},{\"1\":\"WY\",\"2\":\"UINTA\",\"3\":\"49\"},{\"1\":\"WY\",\"2\":\"WASHAKIE\",\"3\":\"10\"},{\"1\":\"WY\",\"2\":\"WESTON\",\"3\":\"37\"},{\"1\":\"WY Total\",\"2\":\"/\",\"3\":\"2876\"},{\"1\":\"Grand Total\",\"2\":\"/\",\"3\":\"255432\"},{\"1\":\"CANADA\",\"2\":\"Canada\",\"3\":\"662\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nstr(data_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [2,985 × 3] (S3: tbl_df/tbl/data.frame)\n $ STATE : chr [1:2985] \"AE\" \"AE Total1\" \"AK\" \"AK\" ...\n $ COUNTY: chr [1:2985] \"APO\" \"/\" \"ANCHORAGE\" \"FAIRBANKS NORTH STAR\" ...\n $ TOTAL : num [1:2985] 2 2 7 2 3 2 1 88 103 102 ...\n```\n:::\n:::\n\n\n### Briefly describe the data\nThis dataset, which consists of 2,985 rows and 3 columns, captures the following information:\n\n- `STATE`: This is a character variable representing state abbreviations such as \"AE\", \"AK\".\n- `COUNTY`: This is a character variable indicating county names such as \"APO\", \"ANCHORAGE\".\n- `TOTAL`: This is a numerical variable that denotes the total number of employees in each county.\n\nFrom my understanding, the dataset provides information on employment numbers distributed across various counties in multiple US states.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate total employment by state\ndata_clean <- data_clean %>% \n  group_by(STATE) %>% \n  mutate(total_state_employment = sum(TOTAL, na.rm = TRUE))\n\n# Convert state variable into factor\ndata_clean$STATE <- as.factor(data_clean$STATE)\n\n# Changing county names to title case\ndata_clean$COUNTY <- str_to_title(data_clean$COUNTY)\n\n# Checking the structure of our data frame after mutations\nhead(data_clean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_state_employment\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"Apo\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AK\",\"2\":\"Anchorage\",\"3\":\"7\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Fairbanks North Star\",\"3\":\"2\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Juneau\",\"3\":\"3\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Matanuska-Susitna\",\"3\":\"2\",\"4\":\"103\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Join Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a dataset for total state employment\nstate_totals <- data_clean %>%\n  group_by(STATE) %>%\n  summarise(total_state_employment = sum(TOTAL, na.rm = TRUE))\n\n# Create a dataset for county-specific counts\ncounty_counts <- data_clean %>%\n  select(STATE, COUNTY, TOTAL)\n\n# Join the state and county datasets\njoined_data <- left_join(county_counts, state_totals, by = \"STATE\")\n\n# Print the first few rows of the joined data\nhead(joined_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_state_employment\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"Apo\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"AK\",\"2\":\"Anchorage\",\"3\":\"7\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Fairbanks North Star\",\"3\":\"2\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Juneau\",\"3\":\"3\",\"4\":\"103\"},{\"1\":\"AK\",\"2\":\"Matanuska-Susitna\",\"3\":\"2\",\"4\":\"103\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nIn this code, I create two datasets, `state_totals` and `county_counts`, from the original `data_clean`. `state_totals` contains total employment by state and `county_counts` provides employee counts by county. I then join these datasets on the `STATE` column to form `joined_data`, and check the output using `head` and `str` functions.\n\n### Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the proportion of employment for each county within its state\njoined_data <- joined_data %>%\n  mutate(employment_prop = TOTAL / total_state_employment)\n\n# Print the first few rows of the new dataset\nhead(joined_data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"STATE\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"COUNTY\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"TOTAL\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"total_state_employment\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"employment_prop\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"AE\",\"2\":\"Apo\",\"3\":\"2\",\"4\":\"2\",\"5\":\"1.00000000\"},{\"1\":\"AE Total1\",\"2\":\"/\",\"3\":\"2\",\"4\":\"2\",\"5\":\"1.00000000\"},{\"1\":\"AK\",\"2\":\"Anchorage\",\"3\":\"7\",\"4\":\"103\",\"5\":\"0.06796117\"},{\"1\":\"AK\",\"2\":\"Fairbanks North Star\",\"3\":\"2\",\"4\":\"103\",\"5\":\"0.01941748\"},{\"1\":\"AK\",\"2\":\"Juneau\",\"3\":\"3\",\"4\":\"103\",\"5\":\"0.02912621\"},{\"1\":\"AK\",\"2\":\"Matanuska-Susitna\",\"3\":\"2\",\"4\":\"103\",\"5\":\"0.01941748\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Plot the distribution of employment proportions\nggplot(joined_data, aes(x = employment_prop)) +\n  geom_histogram(binwidth = 0.01) +\n  xlim(c(0, 0.2)) +\n  labs(title = \"Distribution of County Employment Proportions Within States\",\n       x = \"Proportion of State Employment\",\n       y = \"Number of Counties\")\n```\n\n::: {.cell-output-display}\n![](Zhongyue_Linchallenge8_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Subset to include only the top 10 states with the highest total employment\ntop_states <- joined_data %>%\n  group_by(STATE) %>%\n  summarise(total_state_employment = sum(total_state_employment)) %>%\n  arrange(desc(total_state_employment)) %>%\n  slice(1:10)\n\n# Filter the original data to include only the top states\nfiltered_data <- joined_data %>% \n  filter(STATE %in% top_states$STATE)\n\n# Plotting the total state employment for the top 10 states\nggplot(filtered_data, aes(x = reorder(STATE, total_state_employment), y = total_state_employment)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  scale_y_continuous(labels = comma) +  # Use comma formatting for the y axis\n  coord_flip() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 8)) +\n  labs(title = \"Total Employment per State (Top 10)\",\n       x = \"State\",\n       y = \"Total Employment\")\n```\n\n::: {.cell-output-display}\n![](Zhongyue_Linchallenge8_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Zhongyue_Linchallenge8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}